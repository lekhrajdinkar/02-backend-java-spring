# EC2 / IaaS
- EC2_01: https://chatgpt.com/c/7ddee1bf-7240-4789-913a-72dae8438d00
- EC2_02 : https://chatgpt.com/c/636011e3-1ce6-4268-8089-47ca3b12c9b9

## facts 
- SSH (ec2-linux,mac,W10+) vs  Putty (ec2-W7,8,9) 
- `EC2 instance Connect` (ec2-any instance) : browser session.
- aws cli installed in ec2.
- ** don't run aws configure on ec2 instances.
- rather, attach IAM role to EC2 instance.

## Instance type
- https://ec2instances.github.io/ [family,version].[size]
- `general purpose` : balanced, eg: t2.micro
- `compute` optimized, c** : gaming server, batch, ML
- `memory` optimized, r**, X** : real-time system, large dataset processing, BI
- `storage` optimized, D**, H1, I3 : File System, data-ware house, cache server, OLTP etc

---
## purchase options
  - On-Demand Instances – short workload, predictable pricing, pay by second (W and Linux) hour (other OS)
  - `Reserved` (1 & 3 years)
    - Reserved Instances, 72% – long workloads, fixed instance type,OS.
    - `Convertible` Reserved Instances, 66% – long workloads with flexible instances types
  - `Savings` Plans (1 & 3 years) – `commitment` to an amount of usage. Flexible : switch OS, inst type.
  - `Spot Instances` 90% – short workloads, cheap, can lose instances (less reliable), 
    - 2min grace period.
    - spot-block  (1-6 hr), no interruption.
    - Stop request and terminate instance manually then.
    - one time vs persistent.
    - maximun price
  - `Spot fleet` : Spot Instances + optional(On demand)
  - `Dedicated Instances` 
    - no other customers will share your hardware. 
    - VM but underlying h/w not shared with other account.
  - `Dedicated Hosts`
    - most expensive 
    - book an entire physical server/racks/building. 
    - control over instance `placement`
    - pay by : physical cores and underlying network socket visibility.

---
## hibernate ec2 
>   - whatever in RAM state (< 150 GB), preserved in EBS root volume. hence bootup fast. 
>   - supported by : C**, M** and T** family instances.
>   - max for 60 days
>   - EBS volumn with Encryption must be enabled.

---
## EC2 components
### A. EC2: Basic components
- `Tenancy`: host, Dedicated, default
- `SSH` key-Pair
- choose - os / `AMI`. can create image on ec2-i. OS boot volumn : gp* or io*
- memory 
- cpu arch: `ARM or AMD`
- `user-data script` / bootstrap  - (install, update, etc task)
- `Placement group`:
  - `cluster`: same AZ, close-proximity. hence high n/w througput
  - `spread`: different AZ, max 7 instance in each AZ.
  - `partition`: partition/racks in different AZ, max 100

---  
### B. EC2: Storage
- [EBS and EFS](../02_storage/01_EBS_EFS.md)

---
### C. EC2: Network
#### EC2: Network: `ENI`
  - Attach `elastic network card` to Ec2 - `flexible`
  - network fail-over :: if ec2-1 is down >> then launch ec2-2 and attach ENI from old instance to new.
  - bound to AZ.
 
  - contains/defines:
    - speed info, eg 10Gbps
    - `VPC` and subnet
    - one IP public + one MAC address.
    - one private (primary) + many secondary private IP
    - elastic IP
    - Security groups.
    
  - > `elastic-IP` vs  ( random Public IP + DNS ) better vs ELB/LB
    
#### EC2: Network: `Security group` 
  - virtual firewalls / traffic rules(60 max) - eg: allow incoming http, SSH traffic.
  - inbound: all traffic blocked by default.
  - outbound : all traffic allow by default

  - `M2M` : apply multiple(max 5) sg on an ec2 instance, apply same sg2 to multipe ec2 insatnces.
    - EC2 instance-1 has sg-1, sg2,etc
    - EC2 instance-2 has sg-1, sg3,etc
  - `region` specific ( sg + region combination )
  - outside EC2
  - `Stateful` 
    - if inbound allows request is allowed, then response is allowed too with further checking rule.
    - unlike ACL (staeless):  inbound rule is checked > req allowed > response came > outbound rule is checked.  
  - always create new SG for `SSH` (22) 
    - ssh -i "path/to/your-key-file.pem" -p 22 ec2-user@your-ec2-public-dns
    - use keypair over password
  - inbound RULES:
    - Protocol (TCP, UDP, RDP etc)
    - `Source` IP range/CIDR + `another SG`
      - 203.0.113.1/32 (specfic IP)
      - 0.0.0.0/0 (anywhere)
    - `target port` / single or range (target machine which is ec2)
      - classic port: 21,22,80,443, 3389
      - ICMP (Ping)  doesn't use ports
    - outbound RULES:
      - Protocol
      - destination  : IP range/CIDR + `another SG`
      - source port

---
### C. ELB ans ASG
- Elastic load Balancer, Auto Scaling group  : [ELB and ASG](../04_network/01_ELB_ASG.md)

--- 
## Z. Screenshots
> credit: https://www.udemy.com/course/aws-certified-solutions-architect-associate-saa-c03/

- ![img_2.png](../99_img/ec2/img_2.png)
- ![img_1.png](../99_img/ec2/img_1.png)
- ![img.png](../99_img/ec2/img_4.png)
- ![img_1.png](../99_img/ec2/img_3.png)


  