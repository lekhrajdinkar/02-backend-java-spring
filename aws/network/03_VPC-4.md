# VPC 4
```
  - network:0 - AWS VPC-1 (vpc)
  - network:1 - internet (public internet)
  - network:2 - Corporate Network (VPN)
  
  - vgw == `Vitual-private GateWay` 
  - cgw == `Customer gateway` / software+hardware, running on customer side / attached `NAT-device`(public-IP-1)
```
## Network topologies

### Scenario-0 : internet
```
network:0,AWS VPC-1 (`rtb-main`) --> `igw`  --> network:1 : 
```
- create igw-1
- update rtb-main with igw-1 entry.

### Scenario-1 : AWS Site-2-site VPN  
```
network:0,AWS VPC-1  (rtb-main) --> [ vgw <---internet---> cgw ] --> network:2(customer-1) 
- this connection are `encrypted` by default.
```
- Step-1: create `vgw-1`, and attached on AWS VPC-1 
- Step-2: create `cgw-1`, with customer details like - public-IP, etc
- Step-3: create `Site2Site VPN` - connect `cgw-1` with `vgw-1`. next create tunnel
  - `tunnel-1` forward
  - `tunnel-2` backward
  - tunnel1/2 == used for single connection
- Step-4: update `rtb-main` : for traffic forwarding between networks.
- optional steps :
  - update sg on ec2.
  - update ACL on subnet.
- ![img.png](../img/vpc-3/img-s2s-vpn.png)
- ![img.png](../img/vpc-3/demo-1.png)

---
### Scenario-2 : AWS VPN cloudHub
```
- network:0,AWS VPC-1 --> multiple customer/s [ network:2(customer-1), network-3(customer-3),... ]
```
- Step-1: create `vgw-1`, and attached on AWS VPC-1
- Step-2: create `cgw-1,2,3..`, with customer details
- Step-3: create `AWS VPN cloudHub` - link `cgw-1,2,3,...` with `vgw-1`.
- rest of the step same as above.
- ![img.png](../img/vpc-3/img-hub-2.png)

---
### Scenario-3 : DX (Direct Connect)
```
network:0,AWS VPC-1  (rtb-main) --> `[ vgw <--aws-direct-Location,DX  --> DX:endpoint ]` --> network:2(customer-1)
- no internet
```
- key term : `AWS-Direct-location` (physical loc)
  - AWS VPC -> connect to Dx-location
  - customer --> connect to Dx-location
  - thus, eliminate the use of internet. `NO INTERNET`
  - Provides a `dedicated private connection`
  - `DX:endpoint` : endpoint,to connect it. 
  - benefit: high bandwidth with large dataSet + consistent fast n/w.
  - Types:
    - `Dedicated` : wire ethernet, `1,10,100 Gbps`, fastest
    - `hosted`    : via DX partner `50 500 Mbps`, `1 2 5 10 Gbps`, slow
  - lead/wait time for `new connection `: `1 month` <<<< IMP
  - no encryption by default, can add but bit complex.
  - `resiliency`: 
    - notice : eg: 2 conn vs 4 conn
    - ![img.png](../img/vpc-3/img-dx-100.png)

- ![img.png](../img/vpc-3/dx-1.png)

---
### Scenario-4 : DX gateway
```
  - customer is connected to dx-1 via dx-1:endpoint
  - 2 or more different VPC are connecting to same DX
    - AWS `VPC-1` --> connect to AWS-Direct-location, `dx-1`
    - AWS `VPC-2` --> connect to AWS-Direct-location, `dx-1`
    - ...
    - ...
```
  - `way-1` : create 2+ vgw
    - AWS `VPC-1` --> `vgw-1` --> dx-1:endpoint
    - AWS `VPC-2` --> `vgw-2` --> dx-1:endpoint
    - ...
    - ...
    
  - `way-2` : create :  `dxg-1 --> vgw-1 --> dx-1:endpint` , on any region
    - AWS `VPC-1` --> `dxg-1` : update rtb-main of vpc-1 with dxg-1
    - AWS `VPC-2` --> `dxg-1` : update rtb-main of vpc-2 with dxg-1
    - ...
    - ...
    - ![img.png](../img/vpc-3/sxg-1.png)

---
### Scenario-4 :  DX with Site2SiteVPN(backup)
- create primary : DX
- create Secondary : Site2SiteVPN
- ![img.png](../img/vpc-3/scenario-5.png)

---
### Scenario-5 : VPC peering
```
 `Aws1::VPC-1` (subnet-11, subnet-22, ...) <---VPC peer---> `Aws1::VPC-2` (subnet-21, subnet-22)
```
---
##  transient Gateway
- network topolgies can be complicated 
- transient Gateway, simplify above topologies
- define everything at single place : rtb of transient gateway
- supports `IP-multicast` ?
- ![img.png](../img/vpc-3/tgw.png)
- create multiple tunnels in `AWS Site-2-site VPN` : `ECMP routing`
  - ![img.png](../img/vpc-3/ecmp.png)