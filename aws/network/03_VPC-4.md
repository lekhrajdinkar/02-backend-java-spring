# VPC 4

## A. AWS Site-2-site VPN
- Lets have,
```
  - network:0 - AWS VPC-1 (vpc)
  - network:1 - internet (public internet)
  - network:2 - Corporate Network (VPN)
  
  - vgw == `Vitual-private GateWay` | cgw == `Customer gateway`
```

  
- next establish encrypted inter-connection:
  - A. network:0,AWS VPC-1 (`rtb-main`) --> `igw`  --> network:1 : already done
  
  - B. network:0,AWS VPC-1  (rtb-main) --> `[ vgw <---internet---> cgw ]` --> network:2(customer-1)  : learn this now
    - > Note : bts, use internet only 
    - Step-1 
      - create `vgw-1`, and attached on AWS VPC-1 
      - it is connected to customer `Public-IP-1`
    - Step-2 
      - create `cgw-1`, with custoner details 
      - software+hardware, running on customer side.
        - Customer-gateway already having `public-IP-1`
        - if having private IP only, attach `NAT-device`(public-IP-1)
    - Step-3: create Site2Site VPN : connect `cgw-1` with `vgw-1`.
    - Step-4: update `rtb-main` : for traffic forwarding between networks.
    - optional steps :
      - update sg on ec2.
      - update ACL on subnet.
    - ![img.png](../img/vpc-3/img-s2s-vpn.png)
    - All these connection are `encrypted`
    
  - C. network:0,AWS VPC-1 --> multiple customer [ network:2(customer-1), network-3(customer-3),... ]
    - use `AWS VPN cloudHub`
    - ![img.png](../img/vpc-3/img-hub-2.png)
---
- Demo
```
  - create customer gateway, `cgw-1`, attach it to your VPC
  - create Vitual-private GateWay, `vgw-1`
  - create site2site connection
    - link cgw-1 with vgw-1
    - tunnel-1 ... ?
    - tunnel-2 ... ?
    - can skip these for now.
```
- ![img.png](../img/vpc-3/demo-1.png)

---
## B. DX (Direct Connect)
- network:0,AWS VPC-1  (rtb-main) --> `[ vgw <--aws-direct-Location,DX  --> DX:endpoint ]` --> network:2(customer-1)

- key term : `AWS-Direct-location` (physical loc)
  - AWS VPC                       --> connect to AWS-Direct-location
  - on-prem data-center, customer --> connect to AWS-Direct-location
  - thus, eliminate the use of internet. `NO INTERNET`
  - Provides a `dedicated private connection`
  - `DX:endpoint` : endpoint,to connect it. 
  - benefit: high bandwidth with large dataSet + consistent fast n/w.
  - Types:
    - `Dedicated` : wire ethernet, `1,10,100 Gbps`, fastest
    - `hosted`    : via DX partner `50 500 Mbps`, `1 2 5 10 Gbps`, slow
  - lead/wait time for `new connection `: `1 month` <<<< IMP
  - no encryption by default, can add but bit complex.
  - `resiliency`: 
    - notice : eg: 2 conn vs 4 conn
    - ![img.png](../img/vpc-3/img-dx-100.png)
    


- ![img.png](../img/vpc-3/dx-1.png)

---
## DX (Direct Connect) gateway
- Scenario:
  - customer is already connected to dx-1
  - AWS `VPC-1` --> connect to AWS-Direct-location, `dx-1`
  - AWS `VPC-2` --> connect to AWS-Direct-location, `dx-1`
  - ...
  - ...

  - `way-1` : create 2+ vgw
    - AWS `VPC-1` --> `vgw-1` --> dx-1:endpoint
    - AWS `VPC-2` --> `vgw-2` --> dx-1:endpoint
    - ...
    - ...
    
  - `way-2` : create :  `dxg-1 --> vgw-1 --> dx-1:endpint` , on any region
    - AWS `VPC-1` --> `dxg-1`
    - AWS `VPC-2` --> `dxg-1`
    - ...
    - ...
    - ![img.png](../img/vpc-3/sxg-1.png)
