- EC2_01: https://chatgpt.com/c/7ddee1bf-7240-4789-913a-72dae8438d00
- EC2_02 : https://chatgpt.com/c/636011e3-1ce6-4268-8089-47ca3b12c9b9
--- 
# EC2 / ECC (elastic compute cloud)
## 1. Intro
- IaaS
- connect from terminal:
  - **SSH** (OS : linux,mac,W10+) 
    - generate SSH key-Pair
  - **Putty** ( OS: W7,8,9) 
  - **EC2 instance Connect** (Amazon Linux 2) - browser session.
```
- aws cli installed in ec2
- run any commnd, provided IAM permission added on ec2-role
- don't run "aws configure" 
```
- get Instance **metadata**
  - http://169.254.169.254/latest/meta-data/ 
  - instance ID,
  - public IP, private IP, elastic IP, etc
  - ...
  - Retrieve runtime information dynamically
  
```yaml
t2.micro      1     1     EBS-Only          Low to Moderate
t2.xlarge     4     16    EBS-Only          Moderate
c5d.4xlarge   16    32    1 x 400 NVMe SSD  Up to 10 Gbps     
r5.16xlarge   64    512   EBS Only          20 Gbps           
m5.8xlarge    32    128   EBS Only          10 Gbps           
```
---
## 2. ec2: Instance type (family,gen,size) :yellow_circle:
- https://ec2instances.github.io/ 
- https://instances.vantage.sh/
- ![img.png](../99_img/compute/ec2/01/img.png)

### **general purpose** : 
  - balanced, 
  - eg: t2.micro
  - ![img_1.png](../99_img/compute/ec2/01/img_1.png)

### **compute optimized**, 
  - gaming server, media, batch, ML, HPC
  - ![img_2.png](../99_img/compute/ec2/01/img_2.png)

### **memory optimized**
  - real-time system, large dataset processing, BI
  - ![img_3.png](../99_img/compute/ec2/01/img_3.png)

### **storage optimized**
  - File System, RDBMS, data-ware house, cache server, OLTP etc
  - ![img_4.png](../99_img/compute/ec2/01/img_4.png)

---
## 3. Purchase options :yellow_circle:

### 3.1 On-Demand  
- No long-term commitment
- no upfront payment
- **Flexible**
- use case: short workload
- pay by 
  - **second** (after the first minute) (Window and Linux) 
  - **hour** (other OS)

#### Capacity Reservations
- Reserve **On-Demand** instances capacity in a **specific AZ** for **any duration**

### 3.2 Reserved 
- 1 & 3 years
- **fixed** : InstanceType, scope:**Region/AZ**, Tenancy, OS 
- up to 72% discount
- Payment Options – No Upfront (+), Partial Upfront (++), All Upfront (+++)
- use case: 
  - long workloads
  - steady-state usage applications

#### Convertible Reserved 
- upto 66%  discount
- **flexible** : Instance Type, scope:**Region/AZ**, Tenancy, OS
- use case: long workloads with flexible instances types

### 3.3 Savings Plans 
- (1 & 3 years) 
- commitment to an amount of usage.
- Usage beyond EC2 Savings Plans is billed at the On-Demand price :point_left:
- **fixed** : instance family & AWS region
- **Flexible** : Instance Size, OS, Tenancy

### 3.4 Spot Instances 
- upto 90% discount +  MOST cost-efficient
- can lose instances (less reliable), 
- `2 min` **grace period.**
- use case:
  - Not suitable for critical jobs or databases
  - workloads that are **resilient to failure** : Batch jobs, Data Analysis, Image processing, etc
```
select 
    duration/expiry            <<<
    type: one-time/persistent 
    count
    max price                   <<< 
    instance Types, 
    cpu (min.max),
``` 

#### spot block  
- (1-6 hr), no interruption.
- Stop request and terminate instance manually then. :point_left:
- one time vs persistent.

### 3.5 Spot fleet 
- Spot Instances + optional(On demand)

### 3.6. Dedicated Instances
- underlying h/w not shared with **other account**.
- May share hardware with other instances in **same account**

### 3.7 Dedicated Hosts
- most expensive $$
- book an entire physical **server/racks/building**. 
  - for companies that have strong regulatory or compliance needs
- control over **instance placement**
- pay by : 
  - physical cores
  - underlying network socket visibility.
- Purchasing Options
  - On-demand – pay per second for active Dedicated Host
  - Reserved - 1 or 3 years (No Upfront, Partial Upfront, All Upfront)

---
## 4. hibernate
- RAM state ( < `150 GB`), gets preserved in EBS root volume ( with/without **Encryption**).
- hence boot up fast. 
- supported family instances 
  - `C**` 
  - `M**` 
  - `T**`
- max for `60 days`

---
## 5. Placement group :yellow_circle:
- **cluster** 
  - same AZ, close-proximity. hence high n/w througput
- **spread**
  - different AZ, max 7 instance in each AZ.
- **partition**
  - partition/racks in different AZ, max 100
  
---
## 6. provision instance :yellow_circle:
- **Tenancy**
  - host 
  - Dedicated 
  - default
- **OS / AMI** 
  - can create AMI on ec2-i. 
  - OS boot volume : `gp* / io*` :point_left:
- **memory/RAM** 
- **cpu architecture**
  - `ARM` 
  - `AMD`
- **user-data script** 
  - bootstrap script  - automate boot tasks
    - install update
    - install software
    - ...
  - run only once
  - run with **root user** permission.

- **Storage** 
  - [02_storage](../02_storage)
  - Network-attached (EBS & EFS) 
  - hardware (EC2 Instance Store)
  
- **Network** : 
  - [04_network](../04_network)
  - Security group
  - ENI (speed, ips, etc)
- **Elastic load Balancer, Auto Scaling group**  : [ELB and ASG](../04_network/01_ELB_ASG.md)

---
# extra
![img_2.png](../99_img/ec2/img_2.png)

![img_1.png](../99_img/ec2/img_1.png)

![img_5.png](../99_img/compute/ec2/01/img_5.png)



  